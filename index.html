<!DOCTYPE html>
	<html>
		<title>Untitled Duel Game!</title>
	<body>
		<script type="module" >
		//Constants Definition
		const BOARD_HEIGHT     = 5;
		const BOARD_WIDTH      = 10;
		const PLAYER1_COLOR    = "MediumSlateBlue";
		const BACKGROUND_COLOR = "DimGray"
		const TARGETABLE       = "DarkRed"
		const SHOT  = "-->";
		//End Constants 
		document.body.style.backgroundColor = BACKGROUND_COLOR
		var board = document.createElement("table");			
		board.setAttribute("border", 1);
		board.setAttribute("cellPadding", 5);
		board.setAttribute("table-layout", "fixed");
		var curPosition = [2, 1];
		var focusPosition = [2, 1];
		var username = prompt("Enter 3 Letter Username");
		username = username.substr(0, 3);
		var justStarted = true;
		function drawBoard(){
			if(!justStarted)
				board.removeChild(board.getElementsByTagName("tbody")[0]);
			let body = document.createElement("tbody");
			for(let i = 0; i < BOARD_HEIGHT; i++){
				let row = document.createElement("tr");
				for(let j = 0; j < BOARD_WIDTH; j++){
					let cell = document.createElement("td");
					let cellData;
					if(i === curPosition[0] && j === curPosition[1])
						cellData = document.createTextNode("_" + username + "_");
					else
						cellData = document.createTextNode("_____");

					if(i === curPosition[0] - 1 || i === curPosition[0] + 1 || i === curPosition[1] - 1 || i === curPosition[1] + 1)
						cell.style.backgroundColor = TARGETABLE;
					cell.appendChild(cellData);
					row.appendChild(cell);
				}
				body.appendChild(row);
			}
			board.appendChild(body);
			document.body.appendChild(board);
			
			if(justStarted)
				justStarted = !justStarted;
		}
		
		function resetCurser(){
			board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = BACKGROUND_COLOR;
			focusPosition = [curPosition[0], curPosition[1]];
			board.rows[curPosition[0]].cells[curPosition[1]].style.backgroundColor = PLAYER1_COLOR;
			
		}

		function movePlayer(position){
			curPosition[0] = position[0];
			curPosition[1] = position[1];
		}
		//End of Functions
		drawBoard();
		resetCurser();
		//TODO: Create waiting on Lobby screen, not needed for testing
		document.addEventListener('keydown', function(event) {
   		 	if(event.keyCode == 87 && focusPosition[0] - 1 !== -1) {
				//Revert starting position to white
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = BACKGROUND_COLOR;
				//Change focusPosition
				focusPosition = [focusPosition[0] - 1, focusPosition[1]];
				//Change color of new Cell
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = PLAYER1_COLOR;
       		 	//'W was pressed'
    			}
  			else if(event.keyCode == 65 && focusPosition[1] - 1 !== -1) {
        			//Revert starting position to white
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = BACKGROUND_COLOR;
				//Change focusPosition
				focusPosition = [focusPosition[0], focusPosition[1] - 1];
				//Change color of new Cell
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = PLAYER1_COLOR;
			//'A was pressed'
 			}
			else if(event.keyCode == 68 && focusPosition[1] + 1 < BOARD_WIDTH) {
        			//Revert starting position to white
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = BACKGROUND_COLOR;
				//Change focusPosition
				focusPosition = [focusPosition[0], focusPosition[1] + 1];
				//Change color of new Cell
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = PLAYER1_COLOR;
			//'D was pressed'
 			}
			else if(event.keyCode == 83 && focusPosition[0] + 1 < BOARD_HEIGHT) {
        		//Revert starting position to white
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = BACKGROUND_COLOR;
				//Change focusPosition
				focusPosition = [focusPosition[0] + 1, focusPosition[1]];
				//Change color of new Cell
				board.rows[focusPosition[0]].cells[focusPosition[1]].style.backgroundColor = PLAYER1_COLOR;
			//'S was pressed'
 			}
			else if(event.keyCode == 32 || event.keyCode == 13){
				movePlayer(focusPosition);
				drawBoard();
				resetCurser();
			//Space or Enter was pressed.	
			}
			
		});
		</script>
		
	</html>
